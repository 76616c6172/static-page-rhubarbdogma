<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cluton Map</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        .header-link {
            font-family: "Times New Roman", serif;
            font-size: 1.5rem;
            text-decoration: none;
            color: inherit;
        }
        .header-link:hover {
            text-decoration: underline;
        }
        .header {
            position: absolute;
            top: 0;
            left: 0;
            margin: 1rem;
        }
        .image-container {
            position: relative;
            transform: scale(1.3);
            transform-origin: center center;
        }
        img {
            display: block;
        }
        .highlight-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .image-map {
            margin-bottom: 20px;
        }
        .hidden {
            display: none;
        }
        button.reset-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 1000;
        }
        button.reset-button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <header class="header">
        <a href="/" class="header-link">rhubarb dogma</a>
    </header>

    <!-- Level 1: Main Cluton Map -->
    <div id="level1" class="image-map">
        <div class="image-container">
            <img src="cluton map/cluton main.jpg" usemap="#map1" alt="Cluton Map">
            <map name="map1">
                <area target="_self" alt="Cluton Map" title="Cluton Map" 
                      href="#level2"
                      coords="228,244,210,238,197,234,186,231,174,226,162,217,148,218,135,218,118,216,101,216,86,221,71,230,66,245,69,253,77,264,81,276,87,286,97,296,110,304,117,313,128,321,138,330,154,336,164,341,174,348,181,355,194,357,208,360,220,364,234,365,247,366,262,368,275,369,286,373,297,378,305,381,312,377,321,374,329,375,337,376,346,376,356,372,362,371,374,368,384,361,389,354,391,342,390,332,386,322,379,312,370,305,359,296,339,286,322,282,309,277,300,269,280,264,271,264,265,257,254,256,237,252" 
                      shape="poly">
                <area target="_self" alt="Cluton Map" title="Cluton Map" 
                      href="#level25"
                      coords="594,94,576,96,560,99,549,104,544,108,543,111,544,118,548,119,555,121,562,122,569,122,579,122,586,126,598,127,608,127,617,126,625,126,632,126,641,126,650,126,657,128,666,128,675,129,683,130,694,130,707,131,721,133,732,133,741,133,749,131,759,130,767,129,776,129,788,125,795,120,797,113,793,106,786,101,780,98,767,94,754,93,741,94,734,91,726,90,715,90,705,90,694,91,683,90,668,90,658,89,645,90,631,91,621,91,611,93" 
                      shape="poly">           
            </map>
        </div>
    </div>

    <!-- Level 2: Cluton Crater to Addicts -->
    <div id="level2" class="image-map hidden">
        <div class="image-container">
            <img src="cluton map/cluton crater.jpg" usemap="#map2" alt="Cluton Crater">
            <map name="map2">
                <area target="_self"  
                      href="#level3"
                      coords="381,160,349,164,336,168,321,170,307,175,292,182,279,189,263,195,247,205,235,215,223,225,203,234,196,241,187,248,179,256,174,266,171,277,163,291,161,305,167,321,174,331,182,343,191,350,197,359,210,365,222,373,234,373,245,373,253,378,262,382,274,387,285,393,297,398,307,401,325,404,341,403,353,402,365,402,380,406,395,410,407,415,423,419,442,424,457,424,467,425,479,422,494,419,504,415,514,413,529,414,544,413,553,411,566,411,577,411,586,411,598,411,613,409,626,409,647,409,662,405,679,403,695,397,709,392,717,383,729,374,741,367,754,358,763,350,765,337,765,321,765,308,770,294,769,283,764,275,753,265,741,255,729,245,717,238,705,228,690,219,681,210,670,201,659,191,653,182,642,177,633,179,621,177,614,170,598,165,583,159,569,159,557,158,547,156,535,154,523,150,503,149,472,150,453,153,433,155,411,159,398,162" 
                      shape="poly">
            </map>
        </div>
    </div>

      <!-- Level 2.5: Cluton Crater to Hippies -->

      <div id="level25" class="image-map hidden">
        <div class="image-container">
            <img src="cluton map/cluton hippies.jpg" usemap="#map25">
            <map name="map25">
                <area target="_self"  
                    href="#level4"
                    coords="894,38,894,47,893,58,893,66,894,71,903,73,912,72,915,73,915,81,915,93,923,86,932,79,938,73,945,64,954,55,948,47,940,39,933,32,926,25,917,17,915,38"
                    shape="poly">
            </map>
        </div>
    </div>

    <!-- Level 3: Cluton Addicts to Shop -->
    <div id="level3" class="image-map hidden">
        <div class="image-container">
            <img src="cluton map/cluton addicts.jpg" 
                <area target="_self"  
                      href="#level4"
                      coords="510,118,501,109,496,99,497,88,501,82,507,76,513,71,521,65,530,62,534,56,541,51,548,47,554,44,563,41,571,39,581,36,587,37,594,33,601,32,609,32,616,32,623,29,629,27,635,29,643,31,650,31,658,30,666,27,675,27,678,30,673,34,666,38,657,43,652,49,657,54,662,59,665,66,662,72,657,75,654,81,657,86,664,86,672,85,678,88,683,93,685,99,685,105,680,112,673,114,669,119,669,124,662,128,602,129,540,123,529,123,521,123" 
                      shape="poly">
            </map>
        </div>
    </div>

    <!-- Level 4: Cluton Hippies to Hallucination -->
    <div id="level4" class="image-map hidden">
        <div class="image-container">
            <img src="cluton map/cluton hallucination.jpg" 
            <area target="_self" 
            href="#level4" 
            coords="894,38,894,47,893,58,893,66,894,71,903,73,912,72,915,73,915,81,915,93,923,86,932,79,938,73,945,64,954,55,948,47,940,39,933,32,926,25,917,17,915,38" 
            shape="poly">
        </map>
        </div>
    </div>

    <button class="reset-button" onclick="resetToLevel(1)">Return to Main Map</button>

    <script>
        // Intercept clicks on area elements
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'AREA') {
                e.preventDefault();
                const href = e.target.getAttribute('href');
                if (href && href.startsWith('#level')) {
                    const level = parseInt(href.replace('#level', ''));
                    showLevel(level);
                }
            }
        });

        function createPolygonPath(coords) {
            const points = coords.split(',').map(Number);
            let path = '';
            for (let i = 0; i < points.length; i += 2) {
                path += `${points[i]},${points[i + 1]} `;
            }
            return path.trim();
        }

        function createHighlight(area) {
            const container = area.closest('.image-container');
            const img = container.querySelector('img');

            let highlightContainer = container.querySelector('.highlight-container');
            if (!highlightContainer) {
                highlightContainer = document.createElement('div');
                highlightContainer.className = 'highlight-container';
                container.appendChild(highlightContainer);
            }

            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.setAttribute('viewBox', `0 0 ${img.naturalWidth} ${img.naturalHeight}`);
            svg.style.pointerEvents = 'none';

            const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            polygon.setAttribute('points', createPolygonPath(area.coords));
            polygon.setAttribute('fill', 'none');

            svg.appendChild(polygon);
            highlightContainer.appendChild(svg);

            area.polygonEl = polygon;
        }

        function showLevel(levelNum) {
            document.querySelectorAll('.image-map').forEach(el => {
                el.classList.add('hidden');
            });
            
            const targetLevel = document.getElementById('level' + levelNum);
            if (targetLevel) {
                targetLevel.classList.remove('hidden');
                // Initialize highlights for the newly shown level
                initializeHighlights(targetLevel);
            } else {
                console.log('Level ' + levelNum + ' not found');
            }
        }

        function resetToLevel(levelNum) {
            showLevel(levelNum);
        }

        function initializeHighlights(container) {
            const areas = container.querySelectorAll('area');
            areas.forEach(area => {
                createHighlight(area);

                area.addEventListener('mouseenter', () => {
                    if (area.polygonEl) {
                        area.polygonEl.setAttribute('stroke', 'rgba(105, 105, 105, 0.5)');
                        area.polygonEl.setAttribute('stroke-width', '2');
                        area.polygonEl.style.filter = 'drop-shadow(0 0 20px dimgrey)';
                    }
                });

                area.addEventListener('mouseleave', () => {
                    if (area.polygonEl) {
                        area.polygonEl.removeAttribute('stroke');
                        area.polygonEl.removeAttribute('stroke-width');
                        area.polygonEl.style.filter = 'none';
                    }
                });
            });
        }

        // Initialize highlights for the first level when the page loads
        window.addEventListener('load', () => {
            initializeHighlights(document.getElementById('level1'));
        });
    </script>
</body>
</html>